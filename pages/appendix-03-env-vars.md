附录03-环境变量
===============================================================================
环境变量在 [06-环境变量](./06-env-vars.md) 章节得到了简单的介绍,
而本章节将做一个较为详细的列表

**环境变量** 也被叫做 **内置变量 (built-in variables)**


逻辑自身信息
-------------------------------------------------------------------------------
和逻辑本身相关

- **@this**: 逻辑块建筑自身
- **@thisx**: 逻辑块的 x 坐标, 类似 `sensor thisx @this @x`
- **@thisy**: 逻辑块的 y 坐标, 类似 `sensor thisy @this @y`
- **@links**: 逻辑块链接的建筑数量
- **@unit**: 当前绑定的单位
- **@ipt**: 逻辑块在一个标准帧[^1]内执行多少行
- **@counter**: 逻辑块内当前行之后将要执行的行号


常量
-------------------------------------------------------------------------------

- **false**: `0`值
- **true**: `1`值
- **null**: `null`值
- **@pi**: 圆周率值
- **π**: 同`@pi`
- **@e**: 自然常数值
- **@degToRad**: 角度转弧度使用的比例系数, 定义: `@pi / 180`, 使用: `270*@degToRad`
- **@radToDeg**: 弧度转角度使用的比例系数, 定义: `180 / @pi`, 使用: `@pi*@radToDeg`


世界
-------------------------------------------------------------------------------
和世界相关的量

- **@time**: 游戏经过的时间(通常自创建以来), 按毫秒记
- **@tick**: 游戏经过的标准帧[^1]
- **@second**: 游戏经过的时间, 按秒记
- **@minute**: 游戏经过的时间, 按分记
- **@waveNumber**: 当前出怪波数
- **@waveTime**: 下一波时间, 按秒记
- **@mapw**: 地图宽度
- **@maph**: 地图高度
- **@wait**: 这个环境变量似乎和世处命令`message`有关, 但并没有实际应用


网络相关 (特权)
-------------------------------------------------------------------------------
关于世处(特权处理器)和客户端服务端通信相关的一些变量

暂时没研究这些具体干嘛的, 貌似可以判定在客户端还是服务端,
和独属于客户端的一些信息

- **@server**: 如果此时处理器运行在服务器或单人游戏则为真, 否则为假
- **@client**: 如果此时处理器运行在连接至服务器的客户端则为真, 否则为假
- **@clientLocale**: 运行代码的客户端的区域(语言相关)设置, 如`en_US`
- **@clientUnit**: 运行代码的客户端所代表的单位
- **@clientName**: 运行代码的客户端的玩家名称
- **@clientTeam**: 运行代码的客户端的玩家队伍 ID
- **@clientMobile**: 运行代码的客户端为移动设备则为真, 否则为假

> [!NOTE]
> 逻辑运行代码在服务器时, 服务器和客户端的逻辑是各自分开运行的,
> 只是通常运行结果相同不易察觉


特殊枚举变量
-------------------------------------------------------------------------------
用于特殊用途的枚举变量

- **@ctrlProcessor @ctrlPlayer @ctrlCommand**: 用于传感器的`@controlled`返回结果,
  在旧版本还有 **@ctrlFormation** 用于表示单位在编队中,
  目前编队功能已被删除, 相同的值被 **@ctrlCommand** 所替代


杂项
-------------------------------------------------------------------------------
- **@sfx-...**: 用于表示声音id的环境变量, `...`处为具体声音, 例如 **@sfx-pew**


Content 相关
-------------------------------------------------------------------------------
一些以 content 为主的环境变量

- team:    队伍相关的环境变量, 如 **@sharded @crux @green**
- item:    物品相关的环境变量, 如 **@copper @lead**
- liquid:  液体相关的环境变量, 如 **@water @oil**
- block:   建筑相关的环境变量, 如 **@arc @liquid-tank**
- unit:    单位相关的环境变量, 如 **@poly @flare**
- color:   颜色相关的环境变量, 如 **@colorRed @colorPurple**
- weather: 天气相关的环境变量, 如 **@rain @snow**
- sensor:  传感器选项环境变量, 如 **@x @dead**

还有一些较为特殊的环境变量, 如 **@empty @air**


Lookup 相关
-------------------------------------------------------------------------------
主要配合 lookup 语句使用的计数, 反应了某类(如建筑是一类) content 环境变量的总数

- **@itemCount**: 物品 content 总数
- **@unitCount**: 单位 content 总数
- **@blockCount**: 建筑 content 总数
- **@liquidCount**: 液体 content 总数


[^1]: 用于衡量计算的标准帧数, 每秒有 60 个标准帧

---
[目录](./README.md)
